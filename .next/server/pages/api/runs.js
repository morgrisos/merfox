"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/runs";
exports.ids = ["pages/api/runs"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "csv-parse/sync":
/*!*********************************!*\
  !*** external "csv-parse/sync" ***!
  \*********************************/
/***/ ((module) => {

module.exports = import("csv-parse/sync");;

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fruns&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fruns%2Findex.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fruns&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fruns%2Findex.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_runs_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/runs/index.ts */ \"(api)/./src/pages/api/runs/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_runs_index_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_runs_index_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_runs_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_runs_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/runs\",\n        pathname: \"/api/runs\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_runs_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnJ1bnMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlMkZwYWdlcyUyRmFwaSUyRnJ1bnMlMkZpbmRleC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUMwRDtBQUMxRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMseURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHlEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL21lcmZveC8/MzIzYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9ydW5zL2luZGV4LnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcnVuc1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3J1bnNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fruns&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fruns%2Findex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/lib/runUtils.ts":
/*!*****************************!*\
  !*** ./src/lib/runUtils.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getGlobalMappingPath: () => (/* binding */ getGlobalMappingPath),\n/* harmony export */   getRunDir: () => (/* binding */ getRunDir),\n/* harmony export */   getRunsDir: () => (/* binding */ getRunsDir)\n/* harmony export */ });\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction getRunsDir() {\n    if (process.env.MERFOX_RUNS_DIR) return process.env.MERFOX_RUNS_DIR;\n    if (process.env.MERFOX_USER_DATA) return path__WEBPACK_IMPORTED_MODULE_1___default().join(process.env.MERFOX_USER_DATA, \"MerFox/runs\");\n    if (true) return path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"runs_dev\");\n    return path__WEBPACK_IMPORTED_MODULE_1___default().join(os__WEBPACK_IMPORTED_MODULE_2___default().homedir(), \"Library/Application Support/merfox/MerFox/runs\");\n}\nfunction getGlobalMappingPath() {\n    const runsDir = getRunsDir();\n    return path__WEBPACK_IMPORTED_MODULE_1___default().join(path__WEBPACK_IMPORTED_MODULE_1___default().dirname(runsDir), \"mapping.csv\"); // .../MerFox/mapping.csv\n}\nasync function getRunDir(runId) {\n    const runsDir = getRunsDir();\n    const directPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(runsDir, runId);\n    try {\n        await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().access(directPath);\n    } catch  {\n        return null;\n    }\n    // 1. Search for subfolder <YYYY-MM-DD_runNNN>\n    try {\n        const entries = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readdir(directPath, {\n            withFileTypes: true\n        });\n        const subdirs = entries.filter((e)=>e.isDirectory() && /^\\d{4}-\\d{2}-\\d{2}_run\\d{3}$/.test(e.name)).map((e)=>e.name).sort().reverse();\n        if (subdirs.length > 0) {\n            return path__WEBPACK_IMPORTED_MODULE_1___default().join(directPath, subdirs[0]);\n        }\n    } catch (e) {\n        console.error(\"Run sub-search failed:\", e);\n    }\n    // 2. Fallback: Check if direct path has raw.csv (Legacy flat)\n    try {\n        await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().access(path__WEBPACK_IMPORTED_MODULE_1___default().join(directPath, \"raw.csv\"));\n        return directPath;\n    } catch  {}\n    return null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL3J1blV0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUE2QjtBQUNMO0FBQ0o7QUFFYixTQUFTRztJQUNaLElBQUlDLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZSxFQUFFLE9BQU9GLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZTtJQUNuRSxJQUFJRixRQUFRQyxHQUFHLENBQUNFLGdCQUFnQixFQUFFLE9BQU9OLGdEQUFTLENBQUNHLFFBQVFDLEdBQUcsQ0FBQ0UsZ0JBQWdCLEVBQUU7SUFDakYsSUFBSUgsSUFBeUIsRUFBZSxPQUFPSCxnREFBUyxDQUFDRyxRQUFRSyxHQUFHLElBQUk7SUFDNUUsT0FBT1IsZ0RBQVMsQ0FBQ0MsaURBQVUsSUFBSTtBQUNuQztBQUVPLFNBQVNTO0lBQ1osTUFBTUMsVUFBVVQ7SUFDaEIsT0FBT0YsZ0RBQVMsQ0FBQ0EsbURBQVksQ0FBQ1csVUFBVSxnQkFBZ0IseUJBQXlCO0FBQ3JGO0FBRU8sZUFBZUUsVUFBVUMsS0FBYTtJQUN6QyxNQUFNSCxVQUFVVDtJQUNoQixNQUFNYSxhQUFhZixnREFBUyxDQUFDVyxTQUFTRztJQUV0QyxJQUFJO1FBQ0EsTUFBTWYseURBQVMsQ0FBQ2dCO0lBQ3BCLEVBQUUsT0FBTTtRQUNKLE9BQU87SUFDWDtJQUVBLDhDQUE4QztJQUM5QyxJQUFJO1FBQ0EsTUFBTUUsVUFBVSxNQUFNbEIsMERBQVUsQ0FBQ2dCLFlBQVk7WUFBRUksZUFBZTtRQUFLO1FBQ25FLE1BQU1DLFVBQVVILFFBQ1hJLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsV0FBVyxNQUFNLCtCQUErQkMsSUFBSSxDQUFDRixFQUFFRyxJQUFJLEdBQ3pFQyxHQUFHLENBQUNKLENBQUFBLElBQUtBLEVBQUVHLElBQUksRUFDZkUsSUFBSSxHQUFHQyxPQUFPO1FBRW5CLElBQUlSLFFBQVFTLE1BQU0sR0FBRyxHQUFHO1lBQ3BCLE9BQU83QixnREFBUyxDQUFDZSxZQUFZSyxPQUFPLENBQUMsRUFBRTtRQUMzQztJQUNKLEVBQUUsT0FBT0UsR0FBRztRQUNSUSxRQUFRQyxLQUFLLENBQUMsMEJBQTBCVDtJQUM1QztJQUVBLDhEQUE4RDtJQUM5RCxJQUFJO1FBQ0EsTUFBTXZCLHlEQUFTLENBQUNDLGdEQUFTLENBQUNlLFlBQVk7UUFDdEMsT0FBT0E7SUFDWCxFQUFFLE9BQU0sQ0FBRTtJQUVWLE9BQU87QUFDWCIsInNvdXJjZXMiOlsid2VicGFjazovL21lcmZveC8uL3NyYy9saWIvcnVuVXRpbHMudHM/YTFjZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgb3MgZnJvbSAnb3MnO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UnVuc0RpcigpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTUVSRk9YX1JVTlNfRElSKSByZXR1cm4gcHJvY2Vzcy5lbnYuTUVSRk9YX1JVTlNfRElSO1xuICAgIGlmIChwcm9jZXNzLmVudi5NRVJGT1hfVVNFUl9EQVRBKSByZXR1cm4gcGF0aC5qb2luKHByb2Nlc3MuZW52Lk1FUkZPWF9VU0VSX0RBVEEsICdNZXJGb3gvcnVucycpO1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JykgcmV0dXJuIHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncnVuc19kZXYnKTtcbiAgICByZXR1cm4gcGF0aC5qb2luKG9zLmhvbWVkaXIoKSwgJ0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9tZXJmb3gvTWVyRm94L3J1bnMnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbE1hcHBpbmdQYXRoKCkge1xuICAgIGNvbnN0IHJ1bnNEaXIgPSBnZXRSdW5zRGlyKCk7XG4gICAgcmV0dXJuIHBhdGguam9pbihwYXRoLmRpcm5hbWUocnVuc0RpciksICdtYXBwaW5nLmNzdicpOyAvLyAuLi4vTWVyRm94L21hcHBpbmcuY3N2XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSdW5EaXIocnVuSWQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgIGNvbnN0IHJ1bnNEaXIgPSBnZXRSdW5zRGlyKCk7XG4gICAgY29uc3QgZGlyZWN0UGF0aCA9IHBhdGguam9pbihydW5zRGlyLCBydW5JZCk7XG5cbiAgICB0cnkge1xuICAgICAgICBhd2FpdCBmcy5hY2Nlc3MoZGlyZWN0UGF0aCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIDEuIFNlYXJjaCBmb3Igc3ViZm9sZGVyIDxZWVlZLU1NLUREX3J1bk5OTj5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBlbnRyaWVzID0gYXdhaXQgZnMucmVhZGRpcihkaXJlY3RQYXRoLCB7IHdpdGhGaWxlVHlwZXM6IHRydWUgfSk7XG4gICAgICAgIGNvbnN0IHN1YmRpcnMgPSBlbnRyaWVzXG4gICAgICAgICAgICAuZmlsdGVyKGUgPT4gZS5pc0RpcmVjdG9yeSgpICYmIC9eXFxkezR9LVxcZHsyfS1cXGR7Mn1fcnVuXFxkezN9JC8udGVzdChlLm5hbWUpKVxuICAgICAgICAgICAgLm1hcChlID0+IGUubmFtZSlcbiAgICAgICAgICAgIC5zb3J0KCkucmV2ZXJzZSgpO1xuXG4gICAgICAgIGlmIChzdWJkaXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBwYXRoLmpvaW4oZGlyZWN0UGF0aCwgc3ViZGlyc1swXSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1J1biBzdWItc2VhcmNoIGZhaWxlZDonLCBlKTtcbiAgICB9XG5cbiAgICAvLyAyLiBGYWxsYmFjazogQ2hlY2sgaWYgZGlyZWN0IHBhdGggaGFzIHJhdy5jc3YgKExlZ2FjeSBmbGF0KVxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGZzLmFjY2VzcyhwYXRoLmpvaW4oZGlyZWN0UGF0aCwgJ3Jhdy5jc3YnKSk7XG4gICAgICAgIHJldHVybiBkaXJlY3RQYXRoO1xuICAgIH0gY2F0Y2ggeyB9XG5cbiAgICByZXR1cm4gbnVsbDtcbn1cbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJvcyIsImdldFJ1bnNEaXIiLCJwcm9jZXNzIiwiZW52IiwiTUVSRk9YX1JVTlNfRElSIiwiTUVSRk9YX1VTRVJfREFUQSIsImpvaW4iLCJjd2QiLCJob21lZGlyIiwiZ2V0R2xvYmFsTWFwcGluZ1BhdGgiLCJydW5zRGlyIiwiZGlybmFtZSIsImdldFJ1bkRpciIsInJ1bklkIiwiZGlyZWN0UGF0aCIsImFjY2VzcyIsImVudHJpZXMiLCJyZWFkZGlyIiwid2l0aEZpbGVUeXBlcyIsInN1YmRpcnMiLCJmaWx0ZXIiLCJlIiwiaXNEaXJlY3RvcnkiLCJ0ZXN0IiwibmFtZSIsIm1hcCIsInNvcnQiLCJyZXZlcnNlIiwibGVuZ3RoIiwiY29uc29sZSIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/lib/runUtils.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/runs/index.ts":
/*!*************************************!*\
  !*** ./src/pages/api/runs/index.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var csv_parse_sync__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! csv-parse/sync */ \"csv-parse/sync\");\n/* harmony import */ var _lib_runUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/runUtils */ \"(api)/./src/lib/runUtils.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([csv_parse_sync__WEBPACK_IMPORTED_MODULE_2__]);\ncsv_parse_sync__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n// csv-parse might need install if missing in V4, assuming present\n\n\nfunction findColumnValue(record, candidates) {\n    const keys = Object.keys(record);\n    for (const candidate of candidates){\n        if (record[candidate] !== undefined) return record[candidate];\n        const foundKey = keys.find((k)=>k.toLowerCase() === candidate.toLowerCase());\n        if (foundKey) return record[foundKey];\n    }\n    return undefined;\n}\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const runsDir = (0,_lib_runUtils__WEBPACK_IMPORTED_MODULE_3__.getRunsDir)();\n        try {\n            await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().access(runsDir);\n        } catch  {\n            return res.json({\n                data: [],\n                meta: {\n                    scanPath: runsDir,\n                    error: \"Directory not found\"\n                }\n            });\n        }\n        const entries = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readdir(runsDir, {\n            withFileTypes: true\n        });\n        const runDirs = entries.filter((e)=>e.isDirectory()).map((e)=>e.name);\n        const runs = [];\n        // Limit scanning if requested (simple impl)\n        // const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n        for (const dirName of runDirs){\n            const runIdPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(runsDir, dirName);\n            // Artifact Source Resolution\n            let artifactPath = runIdPath;\n            try {\n                const subEntries = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readdir(runIdPath, {\n                    withFileTypes: true\n                });\n                const subdirs = subEntries.filter((e)=>e.isDirectory() && /^\\d{4}-\\d{2}-\\d{2}_run\\d{3}$/.test(e.name)).map((e)=>e.name).sort().reverse();\n                if (subdirs.length > 0) {\n                    artifactPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(runIdPath, subdirs[0]);\n                }\n            } catch  {}\n            let runFiles = [];\n            try {\n                runFiles = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readdir(artifactPath);\n            } catch  {}\n            const stats = {\n                totalScanned: 0,\n                success: 0,\n                failed: 0\n            };\n            const failureReasonMap = new Map();\n            const failedUrls = [];\n            // Quick scan for failed CSVs\n            const failedCsvs = runFiles.filter((f)=>f.endsWith(\"_failed.csv\"));\n            for (const csvFile of failedCsvs){\n                try {\n                    const content = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(path__WEBPACK_IMPORTED_MODULE_1___default().join(artifactPath, csvFile), \"utf8\");\n                    const bomSafe = content.startsWith(\"\\uFEFF\") ? content.slice(1) : content;\n                    const records = (0,csv_parse_sync__WEBPACK_IMPORTED_MODULE_2__.parse)(bomSafe, {\n                        columns: true,\n                        skip_empty_lines: true,\n                        relax_column_count: true\n                    });\n                    stats.failed += records.length;\n                    // Only process deep failure logic for top 50 or if asked... skipping deep parse for listing speed optimization if needed\n                    // For now, keep it simple/robust\n                    for (const record of records){\n                        const reason = findColumnValue(record, [\n                            \"reason_detail\",\n                            \"reason\",\n                            \"error\",\n                            \"message\",\n                            \"detail\"\n                        ]) || \"Unknown\";\n                        failureReasonMap.set(reason, (failureReasonMap.get(reason) || 0) + 1);\n                        if (failedUrls.length < 5) {\n                            const url = findColumnValue(record, [\n                                \"item_url\",\n                                \"url\",\n                                \"link\"\n                            ]);\n                            const title = findColumnValue(record, [\n                                \"title\",\n                                \"item_title\",\n                                \"name\"\n                            ]);\n                            if (url) failedUrls.push({\n                                url,\n                                reason,\n                                title: title || \"No Title\"\n                            });\n                        }\n                    }\n                } catch  {}\n            }\n            if (runFiles.includes(\"amazon.tsv\")) {\n                try {\n                    const content = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(path__WEBPACK_IMPORTED_MODULE_1___default().join(artifactPath, \"amazon.tsv\"), \"utf8\");\n                    stats.success = Math.max(0, content.trim().split(\"\\n\").length - 1);\n                } catch  {}\n            } else if (runFiles.includes(\"raw.csv\")) {\n                try {\n                    const content = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(path__WEBPACK_IMPORTED_MODULE_1___default().join(artifactPath, \"raw.csv\"), \"utf8\");\n                    stats.success = Math.max(0, content.trim().split(\"\\n\").length - 1);\n                } catch  {}\n            }\n            stats.totalScanned = stats.success + stats.failed;\n            const sortedReasons = Array.from(failureReasonMap.entries()).sort((a, b)=>b[1] - a[1]).map(([reason, count])=>({\n                    reason,\n                    count\n                }));\n            let date = \"\";\n            const dateMatch = dirName.match(/^(\\d{4}-\\d{2}-\\d{2})/);\n            if (dateMatch) date = dateMatch[1];\n            if (!date) {\n                try {\n                    const stat = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().stat(runIdPath);\n                    date = stat.birthtime.toISOString().split(\"T\")[0];\n                } catch  {\n                    date = \"Unknown\";\n                }\n            }\n            runs.push({\n                id: dirName,\n                name: dirName,\n                date,\n                path: runIdPath,\n                stats,\n                failureReasons: sortedReasons,\n                failedUrls,\n                artifacts: {\n                    hasGoogle: false,\n                    hasAmazon: runFiles.includes(\"amazon.tsv\"),\n                    hasProfit: runFiles.includes(\"profit.tsv\"),\n                    hasAsin: runFiles.includes(\"asin.tsv\"),\n                    hasRaw: runFiles.includes(\"raw.csv\"),\n                    hasMapping: runFiles.includes(\"mapping.csv\"),\n                    mapping: await (async ()=>{\n                        if (!runFiles.includes(\"mapping.csv\")) return {\n                            status: \"none\"\n                        };\n                        try {\n                            const content = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(path__WEBPACK_IMPORTED_MODULE_1___default().join(artifactPath, \"mapping.csv\"), \"utf8\");\n                            // BOM check not strictly needed for line counting if just roughly 1-2 lines, but good practice\n                            const lines = content.trim().split(\"\\n\").filter((l)=>l.trim().length > 0);\n                            return {\n                                status: lines.length > 1 ? \"custom\" : \"standard\",\n                                rows: lines.length\n                            };\n                        } catch  {\n                            return {\n                                status: \"none\"\n                            };\n                        }\n                    })()\n                }\n            });\n        }\n        runs.sort((a, b)=>b.name.localeCompare(a.name));\n        res.status(200).json({\n            data: runs,\n            meta: {\n                scanPath: runsDir\n            }\n        });\n    } catch (e) {\n        console.error(\"[API] Error fetching runs:\", e);\n        res.status(500).json({\n            error: \"Failed to fetch runs\",\n            details: e.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL3J1bnMvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUM2QjtBQUNMO0FBQ3hCLGtFQUFrRTtBQUMzQjtBQUNZO0FBRW5ELFNBQVNJLGdCQUFnQkMsTUFBVyxFQUFFQyxVQUFvQjtJQUN0RCxNQUFNQyxPQUFPQyxPQUFPRCxJQUFJLENBQUNGO0lBQ3pCLEtBQUssTUFBTUksYUFBYUgsV0FBWTtRQUNoQyxJQUFJRCxNQUFNLENBQUNJLFVBQVUsS0FBS0MsV0FBVyxPQUFPTCxNQUFNLENBQUNJLFVBQVU7UUFDN0QsTUFBTUUsV0FBV0osS0FBS0ssSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxXQUFXLE9BQU9MLFVBQVVLLFdBQVc7UUFDekUsSUFBSUgsVUFBVSxPQUFPTixNQUFNLENBQUNNLFNBQVM7SUFDekM7SUFDQSxPQUFPRDtBQUNYO0FBRWUsZUFBZUssUUFBUUMsR0FBbUIsRUFBRUMsR0FBb0I7SUFDM0UsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLE9BQU87UUFDdEIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXFCO0lBQzlEO0lBRUEsSUFBSTtRQUNBLE1BQU1DLFVBQVVuQix5REFBVUE7UUFDMUIsSUFBSTtZQUNBLE1BQU1ILHlEQUFTLENBQUNzQjtRQUNwQixFQUFFLE9BQU07WUFDSixPQUFPTCxJQUFJRyxJQUFJLENBQUM7Z0JBQ1pJLE1BQU0sRUFBRTtnQkFDUkMsTUFBTTtvQkFBRUMsVUFBVUo7b0JBQVNELE9BQU87Z0JBQXNCO1lBQzVEO1FBQ0o7UUFFQSxNQUFNTSxVQUFVLE1BQU0zQiwwREFBVSxDQUFDc0IsU0FBUztZQUFFTyxlQUFlO1FBQUs7UUFDaEUsTUFBTUMsVUFBVUgsUUFBUUksTUFBTSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxXQUFXLElBQUlDLEdBQUcsQ0FBQ0YsQ0FBQUEsSUFBS0EsRUFBRUcsSUFBSTtRQUVwRSxNQUFNQyxPQUFPLEVBQUU7UUFFZiw0Q0FBNEM7UUFDNUMsNEVBQTRFO1FBRTVFLEtBQUssTUFBTUMsV0FBV1AsUUFBUztZQUMzQixNQUFNUSxZQUFZckMsZ0RBQVMsQ0FBQ3FCLFNBQVNlO1lBRXJDLDZCQUE2QjtZQUM3QixJQUFJRyxlQUFlRjtZQUNuQixJQUFJO2dCQUNBLE1BQU1HLGFBQWEsTUFBTXpDLDBEQUFVLENBQUNzQyxXQUFXO29CQUFFVCxlQUFlO2dCQUFLO2dCQUNyRSxNQUFNYSxVQUFVRCxXQUNYVixNQUFNLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLFdBQVcsTUFBTSwrQkFBK0JVLElBQUksQ0FBQ1gsRUFBRUcsSUFBSSxHQUN6RUQsR0FBRyxDQUFDRixDQUFBQSxJQUFLQSxFQUFFRyxJQUFJLEVBQ2ZTLElBQUksR0FBR0MsT0FBTztnQkFFbkIsSUFBSUgsUUFBUUksTUFBTSxHQUFHLEdBQUc7b0JBQ3BCTixlQUFldkMsZ0RBQVMsQ0FBQ3FDLFdBQVdJLE9BQU8sQ0FBQyxFQUFFO2dCQUNsRDtZQUNKLEVBQUUsT0FBTSxDQUFFO1lBRVYsSUFBSUssV0FBcUIsRUFBRTtZQUMzQixJQUFJO2dCQUFFQSxXQUFXLE1BQU0vQywwREFBVSxDQUFDd0M7WUFBZSxFQUFFLE9BQU0sQ0FBRTtZQUUzRCxNQUFNUSxRQUFRO2dCQUFFQyxjQUFjO2dCQUFHQyxTQUFTO2dCQUFHQyxRQUFRO1lBQUU7WUFDdkQsTUFBTUMsbUJBQW1CLElBQUlDO1lBQzdCLE1BQU1DLGFBQW9CLEVBQUU7WUFFNUIsNkJBQTZCO1lBQzdCLE1BQU1DLGFBQWFSLFNBQVNoQixNQUFNLENBQUN5QixDQUFBQSxJQUFLQSxFQUFFQyxRQUFRLENBQUM7WUFDbkQsS0FBSyxNQUFNQyxXQUFXSCxXQUFZO2dCQUM5QixJQUFJO29CQUNBLE1BQU1JLFVBQVUsTUFBTTNELDJEQUFXLENBQUNDLGdEQUFTLENBQUN1QyxjQUFja0IsVUFBVTtvQkFDcEUsTUFBTUcsVUFBVUYsUUFBUUcsVUFBVSxDQUFDLFlBQVlILFFBQVFJLEtBQUssQ0FBQyxLQUFLSjtvQkFDbEUsTUFBTUssVUFBVTlELHFEQUFLQSxDQUFDMkQsU0FBUzt3QkFBRUksU0FBUzt3QkFBTUMsa0JBQWtCO3dCQUFNQyxvQkFBb0I7b0JBQUs7b0JBRWpHbkIsTUFBTUcsTUFBTSxJQUFJYSxRQUFRbEIsTUFBTTtvQkFFOUIseUhBQXlIO29CQUN6SCxpQ0FBaUM7b0JBQ2pDLEtBQUssTUFBTXpDLFVBQVUyRCxRQUFTO3dCQUMxQixNQUFNSSxTQUFTaEUsZ0JBQWdCQyxRQUFROzRCQUFDOzRCQUFpQjs0QkFBVTs0QkFBUzs0QkFBVzt5QkFBUyxLQUFLO3dCQUNyRytDLGlCQUFpQmlCLEdBQUcsQ0FBQ0QsUUFBUSxDQUFDaEIsaUJBQWlCa0IsR0FBRyxDQUFDRixXQUFXLEtBQUs7d0JBRW5FLElBQUlkLFdBQVdSLE1BQU0sR0FBRyxHQUFHOzRCQUN2QixNQUFNeUIsTUFBTW5FLGdCQUFnQkMsUUFBUTtnQ0FBQztnQ0FBWTtnQ0FBTzs2QkFBTzs0QkFDL0QsTUFBTW1FLFFBQVFwRSxnQkFBZ0JDLFFBQVE7Z0NBQUM7Z0NBQVM7Z0NBQWM7NkJBQU87NEJBQ3JFLElBQUlrRSxLQUFLakIsV0FBV21CLElBQUksQ0FBQztnQ0FBRUY7Z0NBQUtIO2dDQUFRSSxPQUFPQSxTQUFTOzRCQUFXO3dCQUN2RTtvQkFDSjtnQkFDSixFQUFFLE9BQU0sQ0FBRTtZQUNkO1lBRUEsSUFBSXpCLFNBQVMyQixRQUFRLENBQUMsZUFBZTtnQkFDakMsSUFBSTtvQkFDQSxNQUFNZixVQUFVLE1BQU0zRCwyREFBVyxDQUFDQyxnREFBUyxDQUFDdUMsY0FBYyxlQUFlO29CQUN6RVEsTUFBTUUsT0FBTyxHQUFHeUIsS0FBS0MsR0FBRyxDQUFDLEdBQUdqQixRQUFRa0IsSUFBSSxHQUFHQyxLQUFLLENBQUMsTUFBTWhDLE1BQU0sR0FBRztnQkFDcEUsRUFBRSxPQUFNLENBQUU7WUFDZCxPQUFPLElBQUlDLFNBQVMyQixRQUFRLENBQUMsWUFBWTtnQkFDckMsSUFBSTtvQkFDQSxNQUFNZixVQUFVLE1BQU0zRCwyREFBVyxDQUFDQyxnREFBUyxDQUFDdUMsY0FBYyxZQUFZO29CQUN0RVEsTUFBTUUsT0FBTyxHQUFHeUIsS0FBS0MsR0FBRyxDQUFDLEdBQUdqQixRQUFRa0IsSUFBSSxHQUFHQyxLQUFLLENBQUMsTUFBTWhDLE1BQU0sR0FBRztnQkFDcEUsRUFBRSxPQUFNLENBQUU7WUFDZDtZQUVBRSxNQUFNQyxZQUFZLEdBQUdELE1BQU1FLE9BQU8sR0FBR0YsTUFBTUcsTUFBTTtZQUVqRCxNQUFNNEIsZ0JBQWdCQyxNQUFNQyxJQUFJLENBQUM3QixpQkFBaUJ6QixPQUFPLElBQ3BEaUIsSUFBSSxDQUFDLENBQUNzQyxHQUFHQyxJQUFNQSxDQUFDLENBQUMsRUFBRSxHQUFHRCxDQUFDLENBQUMsRUFBRSxFQUMxQmhELEdBQUcsQ0FBQyxDQUFDLENBQUNrQyxRQUFRZ0IsTUFBTSxHQUFNO29CQUFFaEI7b0JBQVFnQjtnQkFBTTtZQUUvQyxJQUFJQyxPQUFPO1lBQ1gsTUFBTUMsWUFBWWpELFFBQVFrRCxLQUFLLENBQUM7WUFDaEMsSUFBSUQsV0FBV0QsT0FBT0MsU0FBUyxDQUFDLEVBQUU7WUFDbEMsSUFBSSxDQUFDRCxNQUFNO2dCQUNQLElBQUk7b0JBQ0EsTUFBTUcsT0FBTyxNQUFNeEYsdURBQU8sQ0FBQ3NDO29CQUMzQitDLE9BQU9HLEtBQUtDLFNBQVMsQ0FBQ0MsV0FBVyxHQUFHWixLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3JELEVBQUUsT0FBTTtvQkFBRU8sT0FBTztnQkFBVTtZQUMvQjtZQUVBakQsS0FBS3FDLElBQUksQ0FBQztnQkFDTmtCLElBQUl0RDtnQkFDSkYsTUFBTUU7Z0JBQ05nRDtnQkFDQXBGLE1BQU1xQztnQkFDTlU7Z0JBQ0E0QyxnQkFBZ0JiO2dCQUNoQnpCO2dCQUNBdUMsV0FBVztvQkFDUEMsV0FBVztvQkFDWEMsV0FBV2hELFNBQVMyQixRQUFRLENBQUM7b0JBQzdCc0IsV0FBV2pELFNBQVMyQixRQUFRLENBQUM7b0JBQzdCdUIsU0FBU2xELFNBQVMyQixRQUFRLENBQUM7b0JBQzNCd0IsUUFBUW5ELFNBQVMyQixRQUFRLENBQUM7b0JBQzFCeUIsWUFBWXBELFNBQVMyQixRQUFRLENBQUM7b0JBQzlCMEIsU0FBUyxNQUFNLENBQUM7d0JBQ1osSUFBSSxDQUFDckQsU0FBUzJCLFFBQVEsQ0FBQyxnQkFBZ0IsT0FBTzs0QkFBRXZELFFBQVE7d0JBQU87d0JBQy9ELElBQUk7NEJBQ0EsTUFBTXdDLFVBQVUsTUFBTTNELDJEQUFXLENBQUNDLGdEQUFTLENBQUN1QyxjQUFjLGdCQUFnQjs0QkFDMUUsK0ZBQStGOzRCQUMvRixNQUFNNkQsUUFBUTFDLFFBQVFrQixJQUFJLEdBQUdDLEtBQUssQ0FBQyxNQUFNL0MsTUFBTSxDQUFDdUUsQ0FBQUEsSUFBS0EsRUFBRXpCLElBQUksR0FBRy9CLE1BQU0sR0FBRzs0QkFDdkUsT0FBTztnQ0FDSDNCLFFBQVFrRixNQUFNdkQsTUFBTSxHQUFHLElBQUksV0FBVztnQ0FDdEN5RCxNQUFNRixNQUFNdkQsTUFBTTs0QkFDdEI7d0JBQ0osRUFBRSxPQUFNOzRCQUNKLE9BQU87Z0NBQUUzQixRQUFROzRCQUFPO3dCQUM1QjtvQkFDSjtnQkFDSjtZQUNKO1FBQ0o7UUFFQWlCLEtBQUtRLElBQUksQ0FBQyxDQUFDc0MsR0FBR0MsSUFBTUEsRUFBRWhELElBQUksQ0FBQ3FFLGFBQWEsQ0FBQ3RCLEVBQUUvQyxJQUFJO1FBRS9DbEIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUNqQkksTUFBTVk7WUFDTlgsTUFBTTtnQkFBRUMsVUFBVUo7WUFBUTtRQUM5QjtJQUVKLEVBQUUsT0FBT1UsR0FBUTtRQUNieUUsUUFBUXBGLEtBQUssQ0FBQyw4QkFBOEJXO1FBQzVDZixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87WUFBd0JxRixTQUFTMUUsRUFBRTJFLE9BQU87UUFBQztJQUM3RTtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVyZm94Ly4vc3JjL3BhZ2VzL2FwaS9ydW5zL2luZGV4LnRzP2RjYjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuLy8gY3N2LXBhcnNlIG1pZ2h0IG5lZWQgaW5zdGFsbCBpZiBtaXNzaW5nIGluIFY0LCBhc3N1bWluZyBwcmVzZW50XG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2Nzdi1wYXJzZS9zeW5jJztcbmltcG9ydCB7IGdldFJ1bnNEaXIgfSBmcm9tICcuLi8uLi8uLi9saWIvcnVuVXRpbHMnO1xuXG5mdW5jdGlvbiBmaW5kQ29sdW1uVmFsdWUocmVjb3JkOiBhbnksIGNhbmRpZGF0ZXM6IHN0cmluZ1tdKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocmVjb3JkKTtcbiAgICBmb3IgKGNvbnN0IGNhbmRpZGF0ZSBvZiBjYW5kaWRhdGVzKSB7XG4gICAgICAgIGlmIChyZWNvcmRbY2FuZGlkYXRlXSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gcmVjb3JkW2NhbmRpZGF0ZV07XG4gICAgICAgIGNvbnN0IGZvdW5kS2V5ID0ga2V5cy5maW5kKGsgPT4gay50b0xvd2VyQ2FzZSgpID09PSBjYW5kaWRhdGUudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmIChmb3VuZEtleSkgcmV0dXJuIHJlY29yZFtmb3VuZEtleV07XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgICBpZiAocmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJ1bnNEaXIgPSBnZXRSdW5zRGlyKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBmcy5hY2Nlc3MocnVuc0Rpcik7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHtcbiAgICAgICAgICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgICAgICAgICBtZXRhOiB7IHNjYW5QYXRoOiBydW5zRGlyLCBlcnJvcjogJ0RpcmVjdG9yeSBub3QgZm91bmQnIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZW50cmllcyA9IGF3YWl0IGZzLnJlYWRkaXIocnVuc0RpciwgeyB3aXRoRmlsZVR5cGVzOiB0cnVlIH0pO1xuICAgICAgICBjb25zdCBydW5EaXJzID0gZW50cmllcy5maWx0ZXIoZSA9PiBlLmlzRGlyZWN0b3J5KCkpLm1hcChlID0+IGUubmFtZSk7XG5cbiAgICAgICAgY29uc3QgcnVucyA9IFtdO1xuXG4gICAgICAgIC8vIExpbWl0IHNjYW5uaW5nIGlmIHJlcXVlc3RlZCAoc2ltcGxlIGltcGwpXG4gICAgICAgIC8vIGNvbnN0IGxpbWl0ID0gcmVxLnF1ZXJ5LmxpbWl0ID8gcGFyc2VJbnQocmVxLnF1ZXJ5LmxpbWl0IGFzIHN0cmluZykgOiA1MDtcblxuICAgICAgICBmb3IgKGNvbnN0IGRpck5hbWUgb2YgcnVuRGlycykge1xuICAgICAgICAgICAgY29uc3QgcnVuSWRQYXRoID0gcGF0aC5qb2luKHJ1bnNEaXIsIGRpck5hbWUpO1xuXG4gICAgICAgICAgICAvLyBBcnRpZmFjdCBTb3VyY2UgUmVzb2x1dGlvblxuICAgICAgICAgICAgbGV0IGFydGlmYWN0UGF0aCA9IHJ1bklkUGF0aDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3ViRW50cmllcyA9IGF3YWl0IGZzLnJlYWRkaXIocnVuSWRQYXRoLCB7IHdpdGhGaWxlVHlwZXM6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3ViZGlycyA9IHN1YkVudHJpZXNcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihlID0+IGUuaXNEaXJlY3RvcnkoKSAmJiAvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9X3J1blxcZHszfSQvLnRlc3QoZS5uYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgLm1hcChlID0+IGUubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKS5yZXZlcnNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3ViZGlycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFydGlmYWN0UGF0aCA9IHBhdGguam9pbihydW5JZFBhdGgsIHN1YmRpcnNbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggeyB9XG5cbiAgICAgICAgICAgIGxldCBydW5GaWxlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgIHRyeSB7IHJ1bkZpbGVzID0gYXdhaXQgZnMucmVhZGRpcihhcnRpZmFjdFBhdGgpOyB9IGNhdGNoIHsgfVxuXG4gICAgICAgICAgICBjb25zdCBzdGF0cyA9IHsgdG90YWxTY2FubmVkOiAwLCBzdWNjZXNzOiAwLCBmYWlsZWQ6IDAgfTtcbiAgICAgICAgICAgIGNvbnN0IGZhaWx1cmVSZWFzb25NYXAgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuICAgICAgICAgICAgY29uc3QgZmFpbGVkVXJsczogYW55W10gPSBbXTtcblxuICAgICAgICAgICAgLy8gUXVpY2sgc2NhbiBmb3IgZmFpbGVkIENTVnNcbiAgICAgICAgICAgIGNvbnN0IGZhaWxlZENzdnMgPSBydW5GaWxlcy5maWx0ZXIoZiA9PiBmLmVuZHNXaXRoKCdfZmFpbGVkLmNzdicpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY3N2RmlsZSBvZiBmYWlsZWRDc3ZzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKHBhdGguam9pbihhcnRpZmFjdFBhdGgsIGNzdkZpbGUpLCAndXRmOCcpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBib21TYWZlID0gY29udGVudC5zdGFydHNXaXRoKCdcXHVGRUZGJykgPyBjb250ZW50LnNsaWNlKDEpIDogY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjb3JkcyA9IHBhcnNlKGJvbVNhZmUsIHsgY29sdW1uczogdHJ1ZSwgc2tpcF9lbXB0eV9saW5lczogdHJ1ZSwgcmVsYXhfY29sdW1uX2NvdW50OiB0cnVlIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHN0YXRzLmZhaWxlZCArPSByZWNvcmRzLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHByb2Nlc3MgZGVlcCBmYWlsdXJlIGxvZ2ljIGZvciB0b3AgNTAgb3IgaWYgYXNrZWQuLi4gc2tpcHBpbmcgZGVlcCBwYXJzZSBmb3IgbGlzdGluZyBzcGVlZCBvcHRpbWl6YXRpb24gaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBub3csIGtlZXAgaXQgc2ltcGxlL3JvYnVzdFxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWNvcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFzb24gPSBmaW5kQ29sdW1uVmFsdWUocmVjb3JkLCBbJ3JlYXNvbl9kZXRhaWwnLCAncmVhc29uJywgJ2Vycm9yJywgJ21lc3NhZ2UnLCAnZGV0YWlsJ10pIHx8ICdVbmtub3duJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWx1cmVSZWFzb25NYXAuc2V0KHJlYXNvbiwgKGZhaWx1cmVSZWFzb25NYXAuZ2V0KHJlYXNvbikgfHwgMCkgKyAxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWxlZFVybHMubGVuZ3RoIDwgNSkgeyAvLyBMaW1pdCB2YWxpZCBpdGVtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IGZpbmRDb2x1bW5WYWx1ZShyZWNvcmQsIFsnaXRlbV91cmwnLCAndXJsJywgJ2xpbmsnXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBmaW5kQ29sdW1uVmFsdWUocmVjb3JkLCBbJ3RpdGxlJywgJ2l0ZW1fdGl0bGUnLCAnbmFtZSddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXJsKSBmYWlsZWRVcmxzLnB1c2goeyB1cmwsIHJlYXNvbiwgdGl0bGU6IHRpdGxlIHx8ICdObyBUaXRsZScgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIHsgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocnVuRmlsZXMuaW5jbHVkZXMoJ2FtYXpvbi50c3YnKSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZShwYXRoLmpvaW4oYXJ0aWZhY3RQYXRoLCAnYW1hem9uLnRzdicpLCAndXRmOCcpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0cy5zdWNjZXNzID0gTWF0aC5tYXgoMCwgY29udGVudC50cmltKCkuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggeyB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJ1bkZpbGVzLmluY2x1ZGVzKCdyYXcuY3N2JykpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUocGF0aC5qb2luKGFydGlmYWN0UGF0aCwgJ3Jhdy5jc3YnKSwgJ3V0ZjgnKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHMuc3VjY2VzcyA9IE1hdGgubWF4KDAsIGNvbnRlbnQudHJpbSgpLnNwbGl0KCdcXG4nKS5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHsgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdGF0cy50b3RhbFNjYW5uZWQgPSBzdGF0cy5zdWNjZXNzICsgc3RhdHMuZmFpbGVkO1xuXG4gICAgICAgICAgICBjb25zdCBzb3J0ZWRSZWFzb25zID0gQXJyYXkuZnJvbShmYWlsdXJlUmVhc29uTWFwLmVudHJpZXMoKSlcbiAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXG4gICAgICAgICAgICAgICAgLm1hcCgoW3JlYXNvbiwgY291bnRdKSA9PiAoeyByZWFzb24sIGNvdW50IH0pKTtcblxuICAgICAgICAgICAgbGV0IGRhdGUgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IGRhdGVNYXRjaCA9IGRpck5hbWUubWF0Y2goL14oXFxkezR9LVxcZHsyfS1cXGR7Mn0pLyk7XG4gICAgICAgICAgICBpZiAoZGF0ZU1hdGNoKSBkYXRlID0gZGF0ZU1hdGNoWzFdO1xuICAgICAgICAgICAgaWYgKCFkYXRlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdCA9IGF3YWl0IGZzLnN0YXQocnVuSWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IHN0YXQuYmlydGh0aW1lLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHsgZGF0ZSA9ICdVbmtub3duJyB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJ1bnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGRpck5hbWUsXG4gICAgICAgICAgICAgICAgbmFtZTogZGlyTmFtZSxcbiAgICAgICAgICAgICAgICBkYXRlLFxuICAgICAgICAgICAgICAgIHBhdGg6IHJ1bklkUGF0aCxcbiAgICAgICAgICAgICAgICBzdGF0cyxcbiAgICAgICAgICAgICAgICBmYWlsdXJlUmVhc29uczogc29ydGVkUmVhc29ucyxcbiAgICAgICAgICAgICAgICBmYWlsZWRVcmxzLFxuICAgICAgICAgICAgICAgIGFydGlmYWN0czoge1xuICAgICAgICAgICAgICAgICAgICBoYXNHb29nbGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBoYXNBbWF6b246IHJ1bkZpbGVzLmluY2x1ZGVzKCdhbWF6b24udHN2JyksXG4gICAgICAgICAgICAgICAgICAgIGhhc1Byb2ZpdDogcnVuRmlsZXMuaW5jbHVkZXMoJ3Byb2ZpdC50c3YnKSxcbiAgICAgICAgICAgICAgICAgICAgaGFzQXNpbjogcnVuRmlsZXMuaW5jbHVkZXMoJ2FzaW4udHN2JyksXG4gICAgICAgICAgICAgICAgICAgIGhhc1JhdzogcnVuRmlsZXMuaW5jbHVkZXMoJ3Jhdy5jc3YnKSxcbiAgICAgICAgICAgICAgICAgICAgaGFzTWFwcGluZzogcnVuRmlsZXMuaW5jbHVkZXMoJ21hcHBpbmcuY3N2JyksXG4gICAgICAgICAgICAgICAgICAgIG1hcHBpbmc6IGF3YWl0IChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJ1bkZpbGVzLmluY2x1ZGVzKCdtYXBwaW5nLmNzdicpKSByZXR1cm4geyBzdGF0dXM6ICdub25lJyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUocGF0aC5qb2luKGFydGlmYWN0UGF0aCwgJ21hcHBpbmcuY3N2JyksICd1dGY4Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQk9NIGNoZWNrIG5vdCBzdHJpY3RseSBuZWVkZWQgZm9yIGxpbmUgY291bnRpbmcgaWYganVzdCByb3VnaGx5IDEtMiBsaW5lcywgYnV0IGdvb2QgcHJhY3RpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQudHJpbSgpLnNwbGl0KCdcXG4nKS5maWx0ZXIobCA9PiBsLnRyaW0oKS5sZW5ndGggPiAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IGxpbmVzLmxlbmd0aCA+IDEgPyAnY3VzdG9tJyA6ICdzdGFuZGFyZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M6IGxpbmVzLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBzdGF0dXM6ICdub25lJyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBydW5zLnNvcnQoKGEsIGIpID0+IGIubmFtZS5sb2NhbGVDb21wYXJlKGEubmFtZSkpO1xuXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgICAgIGRhdGE6IHJ1bnMsXG4gICAgICAgICAgICBtZXRhOiB7IHNjYW5QYXRoOiBydW5zRGlyIH1cbiAgICAgICAgfSk7XG5cbiAgICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0FQSV0gRXJyb3IgZmV0Y2hpbmcgcnVuczonLCBlKTtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBydW5zJywgZGV0YWlsczogZS5tZXNzYWdlIH0pO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJwYXJzZSIsImdldFJ1bnNEaXIiLCJmaW5kQ29sdW1uVmFsdWUiLCJyZWNvcmQiLCJjYW5kaWRhdGVzIiwia2V5cyIsIk9iamVjdCIsImNhbmRpZGF0ZSIsInVuZGVmaW5lZCIsImZvdW5kS2V5IiwiZmluZCIsImsiLCJ0b0xvd2VyQ2FzZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJydW5zRGlyIiwiYWNjZXNzIiwiZGF0YSIsIm1ldGEiLCJzY2FuUGF0aCIsImVudHJpZXMiLCJyZWFkZGlyIiwid2l0aEZpbGVUeXBlcyIsInJ1bkRpcnMiLCJmaWx0ZXIiLCJlIiwiaXNEaXJlY3RvcnkiLCJtYXAiLCJuYW1lIiwicnVucyIsImRpck5hbWUiLCJydW5JZFBhdGgiLCJqb2luIiwiYXJ0aWZhY3RQYXRoIiwic3ViRW50cmllcyIsInN1YmRpcnMiLCJ0ZXN0Iiwic29ydCIsInJldmVyc2UiLCJsZW5ndGgiLCJydW5GaWxlcyIsInN0YXRzIiwidG90YWxTY2FubmVkIiwic3VjY2VzcyIsImZhaWxlZCIsImZhaWx1cmVSZWFzb25NYXAiLCJNYXAiLCJmYWlsZWRVcmxzIiwiZmFpbGVkQ3N2cyIsImYiLCJlbmRzV2l0aCIsImNzdkZpbGUiLCJjb250ZW50IiwicmVhZEZpbGUiLCJib21TYWZlIiwic3RhcnRzV2l0aCIsInNsaWNlIiwicmVjb3JkcyIsImNvbHVtbnMiLCJza2lwX2VtcHR5X2xpbmVzIiwicmVsYXhfY29sdW1uX2NvdW50IiwicmVhc29uIiwic2V0IiwiZ2V0IiwidXJsIiwidGl0bGUiLCJwdXNoIiwiaW5jbHVkZXMiLCJNYXRoIiwibWF4IiwidHJpbSIsInNwbGl0Iiwic29ydGVkUmVhc29ucyIsIkFycmF5IiwiZnJvbSIsImEiLCJiIiwiY291bnQiLCJkYXRlIiwiZGF0ZU1hdGNoIiwibWF0Y2giLCJzdGF0IiwiYmlydGh0aW1lIiwidG9JU09TdHJpbmciLCJpZCIsImZhaWx1cmVSZWFzb25zIiwiYXJ0aWZhY3RzIiwiaGFzR29vZ2xlIiwiaGFzQW1hem9uIiwiaGFzUHJvZml0IiwiaGFzQXNpbiIsImhhc1JhdyIsImhhc01hcHBpbmciLCJtYXBwaW5nIiwibGluZXMiLCJsIiwicm93cyIsImxvY2FsZUNvbXBhcmUiLCJjb25zb2xlIiwiZGV0YWlscyIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/runs/index.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fruns&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fruns%2Findex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();